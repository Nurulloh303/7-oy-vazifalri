{% extends 'base.html' %}
{% block main %}

<div class="container text-center mt-5">
    <div class="card shadow-lg p-5 rounded-4 border-0">
        <h1 class="display-4 text-primary fw-bold">{{ title }}</h1>
        <p class="lead text-muted">{{ welcome }}</p>
    {% if user.is_authenticated %}
    <a href="{% url 'profile' user.username %}" class="btn btn-lg btn-outline-primary mt-3">
        ðŸš€ Profilga oâ€˜tish
    </a>
    {% else %}
    <a href="{% url 'register' %}" class="btn btn-lg btn-outline-primary mt-3">
        ðŸš€ Profilga oâ€˜tish
    </a>
    {% endif %}
    </div>
</div>

<main>
  <div class="d-flex justify-content-between mt-5 mb-5">
    <div class="col-3">
      <div class="list-group list-group-light">
        {% for genre in genres %}
        <a
          href="{% url 'by_genre' genre.id %}"
          class="list-group-item list-group-item-action px-3 border-0"
          data-mdb-ripple-init
          >{{ genre.type }}</a
        >
        {% endfor %}
      </div>
    </div>
    <div>
      <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for movie in movies %}
        <div class="col">
          <div class="card h-100">
            <a href="{% url 'by_movie' movie.id %}">
              {% if movie.cover %}
              <img
                src="{{ movie.cover.url }}"
                style="width: 380px; height: 400px"
                class="card-img-top"
                alt="Skyscrapers"
              />
              {% else %}
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/No-Image-Placeholder.svg/624px-No-Image-Placeholder.svg.png"
                class="card-img-top"
                alt="No Image Found"
              />
              {% endif %}
            </a>
            <div class="card-body">
              <a href="{%url 'by_movie' movie.id%}"><h5 class="card-title">{{ movie.title }}</h5></a>
              <p class="card-text">
                <b>Director: {{ movie.director }}</b>
                {{ movie.description|truncatewords:10 }}
              </p>
            </div>
            <div class="card-footer">
              <small class="text-muted">
                Sana: {{ movie.release|date:"Y-m-d" }}</small
              >

              {% if movie.author and movie.author.username %}
                <p>Muallif: <a href="{% url 'profile' movie.author.username %}">{{ movie.author.username }}</a></p>
              {% else %}
                <p>Muallif: Nomaâ€™lum</p>
              {% endif %}

              {% if user.is_staff %}
              <a
                href="{% url 'delete_movie' movie.id %}"
                class="btn btn-sm btn-danger"
              >
                <i class="fas fa-trash"></i>
              </a>

              <a
                href="{% url 'update_movie' movie.id %}"
                class="btn btn-sm btn-primary"
              >
                <i class="fas fa-edit"></i>
              </a>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</main>
{% endblock main %}
